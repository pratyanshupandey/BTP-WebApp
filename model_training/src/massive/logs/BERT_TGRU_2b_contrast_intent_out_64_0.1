Using device:  cuda
Using 10 CPU cores
Training new model  <class 'model.TorchGRUIntent'>
Started Training of BERT_TGRU_2b_mha_100
[1, 100] loss: 5.706874
Epoch: 1 Validation loss: 5.06860 accuracy: 0.54255 accuracy_scn: 0.00000
Saving Model in checkpoints/BERT_TGRU_2b_mha_100checkpoint_best
[2, 100] loss: 3.651308
Epoch: 2 Validation loss: 4.20665 accuracy: 0.72110 accuracy_scn: 0.00000
Saving Model in checkpoints/BERT_TGRU_2b_mha_100checkpoint_best
[3, 100] loss: 2.846181
Epoch: 3 Validation loss: 3.69348 accuracy: 0.79242 accuracy_scn: 0.00000
Saving Model in checkpoints/BERT_TGRU_2b_mha_100checkpoint_best
[4, 100] loss: 2.401367
Epoch: 4 Validation loss: 3.51563 accuracy: 0.80226 accuracy_scn: 0.00000
Saving Model in checkpoints/BERT_TGRU_2b_mha_100checkpoint_best
[5, 100] loss: 2.118125
Epoch: 5 Validation loss: 3.42678 accuracy: 0.83128 accuracy_scn: 0.00000
Saving Model in checkpoints/BERT_TGRU_2b_mha_100checkpoint_best
[6, 100] loss: 1.911975
Epoch: 6 Validation loss: 3.26115 accuracy: 0.83915 accuracy_scn: 0.00000
Saving Model in checkpoints/BERT_TGRU_2b_mha_100checkpoint_best
[7, 100] loss: 1.805993
Epoch: 7 Validation loss: 3.20643 accuracy: 0.85047 accuracy_scn: 0.00000
Saving Model in checkpoints/BERT_TGRU_2b_mha_100checkpoint_best
[8, 100] loss: 1.678445
Epoch: 8 Validation loss: 3.33162 accuracy: 0.84948 accuracy_scn: 0.00000
[9, 100] loss: 1.585901
Epoch: 9 Validation loss: 3.21699 accuracy: 0.85440 accuracy_scn: 0.00000
[10, 100] loss: 1.513658
Epoch: 10 Validation loss: 3.26009 accuracy: 0.84506 accuracy_scn: 0.00000
Saving Model in checkpoints/BERT_TGRU_2b_mha_100checkpoint_9
[11, 100] loss: 1.456132
Epoch: 11 Validation loss: 3.31247 accuracy: 0.85588 accuracy_scn: 0.00000
[12, 100] loss: 1.359238
Epoch: 12 Validation loss: 3.23003 accuracy: 0.85047 accuracy_scn: 0.00000
Epoch 00012: reducing learning rate of group 0 to 5.0000e-04.
[13, 100] loss: 1.236534
Epoch: 13 Validation loss: 3.17798 accuracy: 0.86867 accuracy_scn: 0.00000
Saving Model in checkpoints/BERT_TGRU_2b_mha_100checkpoint_best
[14, 100] loss: 1.211164
Epoch: 14 Validation loss: 3.14714 accuracy: 0.87063 accuracy_scn: 0.00000
Saving Model in checkpoints/BERT_TGRU_2b_mha_100checkpoint_best
[15, 100] loss: 1.162307
Epoch: 15 Validation loss: 3.15953 accuracy: 0.86326 accuracy_scn: 0.00000
[16, 100] loss: 1.159923
Epoch: 16 Validation loss: 3.18000 accuracy: 0.86227 accuracy_scn: 0.00000
[17, 100] loss: 1.115874
Epoch: 17 Validation loss: 3.28206 accuracy: 0.85834 accuracy_scn: 0.00000
[18, 100] loss: 1.107305
Epoch: 18 Validation loss: 3.25376 accuracy: 0.85489 accuracy_scn: 0.00000
[19, 100] loss: 1.110354
Epoch: 19 Validation loss: 3.33005 accuracy: 0.86326 accuracy_scn: 0.00000
Epoch 00019: reducing learning rate of group 0 to 2.5000e-04.
[20, 100] loss: 1.049241
Epoch: 20 Validation loss: 3.22107 accuracy: 0.86326 accuracy_scn: 0.00000
Saving Model in checkpoints/BERT_TGRU_2b_mha_100checkpoint_19
[21, 100] loss: 1.024889
Epoch: 21 Validation loss: 3.32806 accuracy: 0.86621 accuracy_scn: 0.00000
[22, 100] loss: 1.031125
Epoch: 22 Validation loss: 3.34020 accuracy: 0.85981 accuracy_scn: 0.00000
[23, 100] loss: 1.017330
Epoch: 23 Validation loss: 3.24206 accuracy: 0.86424 accuracy_scn: 0.00000
Early Stopping the training
Finished Training
Saving Model in checkpoints/BERT_TGRU_2b_mha_100final
Val loss = 3.2420642375946045 	 Val accuracy = 0.8642399907112122 accuracy_scn = 0
Test loss = 3.2718842029571533 	 Test accuracy = 0.8755884170532227 accuracy_scn = 0
