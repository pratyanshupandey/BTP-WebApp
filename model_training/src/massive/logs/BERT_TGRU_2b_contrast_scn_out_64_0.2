Using device:  cuda
Using 10 CPU cores
Training new model  <class 'model.TorchGRUIntent'>
Started Training of BERT_TGRU_2b_mha_100
[1, 100] loss: 9.814691
Epoch: 1 Validation loss: 9.00096 accuracy: 0.37826 accuracy_scn: 0.00000
Saving Model in checkpoints/BERT_TGRU_2b_mha_100checkpoint_best
[2, 100] loss: 7.150796
Epoch: 2 Validation loss: 8.05330 accuracy: 0.52927 accuracy_scn: 0.00000
Saving Model in checkpoints/BERT_TGRU_2b_mha_100checkpoint_best
[3, 100] loss: 6.123047
Epoch: 3 Validation loss: 7.62178 accuracy: 0.60600 accuracy_scn: 0.00000
Saving Model in checkpoints/BERT_TGRU_2b_mha_100checkpoint_best
[4, 100] loss: 5.630778
Epoch: 4 Validation loss: 7.30757 accuracy: 0.65371 accuracy_scn: 0.00000
Saving Model in checkpoints/BERT_TGRU_2b_mha_100checkpoint_best
[5, 100] loss: 5.294199
Epoch: 5 Validation loss: 7.14783 accuracy: 0.70487 accuracy_scn: 0.00000
Saving Model in checkpoints/BERT_TGRU_2b_mha_100checkpoint_best
[6, 100] loss: 4.987010
Epoch: 6 Validation loss: 7.05752 accuracy: 0.75652 accuracy_scn: 0.00000
Saving Model in checkpoints/BERT_TGRU_2b_mha_100checkpoint_best
[7, 100] loss: 4.725502
Epoch: 7 Validation loss: 6.88840 accuracy: 0.76390 accuracy_scn: 0.00000
Saving Model in checkpoints/BERT_TGRU_2b_mha_100checkpoint_best
[8, 100] loss: 4.562191
Epoch: 8 Validation loss: 6.84638 accuracy: 0.78751 accuracy_scn: 0.00000
Saving Model in checkpoints/BERT_TGRU_2b_mha_100checkpoint_best
[9, 100] loss: 4.362276
Epoch: 9 Validation loss: 6.81646 accuracy: 0.81259 accuracy_scn: 0.00000
Saving Model in checkpoints/BERT_TGRU_2b_mha_100checkpoint_best
[10, 100] loss: 4.228767
Epoch: 10 Validation loss: 6.76307 accuracy: 0.80374 accuracy_scn: 0.00000
Saving Model in checkpoints/BERT_TGRU_2b_mha_100checkpoint_best
[11, 100] loss: 4.115280
Epoch: 11 Validation loss: 6.77536 accuracy: 0.81997 accuracy_scn: 0.00000
[12, 100] loss: 4.019241
Epoch: 12 Validation loss: 6.77247 accuracy: 0.83866 accuracy_scn: 0.00000
[13, 100] loss: 3.919231
Epoch: 13 Validation loss: 6.73024 accuracy: 0.84161 accuracy_scn: 0.00000
Saving Model in checkpoints/BERT_TGRU_2b_mha_100checkpoint_best
[14, 100] loss: 3.855366
Epoch: 14 Validation loss: 6.62162 accuracy: 0.84407 accuracy_scn: 0.00000
Saving Model in checkpoints/BERT_TGRU_2b_mha_100checkpoint_best
[15, 100] loss: 3.727798
Epoch: 15 Validation loss: 6.80641 accuracy: 0.84850 accuracy_scn: 0.00000
[16, 100] loss: 3.661274
Epoch: 16 Validation loss: 6.73700 accuracy: 0.85047 accuracy_scn: 0.00000
[17, 100] loss: 3.672457
Epoch: 17 Validation loss: 6.66548 accuracy: 0.85243 accuracy_scn: 0.00000
[18, 100] loss: 3.642617
Epoch: 18 Validation loss: 6.74756 accuracy: 0.85047 accuracy_scn: 0.00000
[19, 100] loss: 3.584509
Epoch: 19 Validation loss: 6.73357 accuracy: 0.85145 accuracy_scn: 0.00000
Epoch 00019: reducing learning rate of group 0 to 5.0000e-04.
[20, 100] loss: 3.460883
Epoch: 20 Validation loss: 6.62993 accuracy: 0.86030 accuracy_scn: 0.00000
Saving Model in checkpoints/BERT_TGRU_2b_mha_100checkpoint_19
[21, 100] loss: 3.407031
Epoch: 21 Validation loss: 6.61772 accuracy: 0.86572 accuracy_scn: 0.00000
Saving Model in checkpoints/BERT_TGRU_2b_mha_100checkpoint_best
[22, 100] loss: 3.378302
Epoch: 22 Validation loss: 6.67387 accuracy: 0.86621 accuracy_scn: 0.00000
[23, 100] loss: 3.385409
Epoch: 23 Validation loss: 6.75169 accuracy: 0.86572 accuracy_scn: 0.00000
[24, 100] loss: 3.314484
Epoch: 24 Validation loss: 6.78816 accuracy: 0.86719 accuracy_scn: 0.00000
[25, 100] loss: 3.319508
Epoch: 25 Validation loss: 6.78862 accuracy: 0.86080 accuracy_scn: 0.00000
[26, 100] loss: 3.336998
Epoch: 26 Validation loss: 6.67773 accuracy: 0.86276 accuracy_scn: 0.00000
Epoch 00026: reducing learning rate of group 0 to 2.5000e-04.
[27, 100] loss: 3.313466
Epoch: 27 Validation loss: 6.71457 accuracy: 0.86818 accuracy_scn: 0.00000
[28, 100] loss: 3.270855
Epoch: 28 Validation loss: 6.72219 accuracy: 0.87063 accuracy_scn: 0.00000
[29, 100] loss: 3.280641
Epoch: 29 Validation loss: 6.65204 accuracy: 0.87063 accuracy_scn: 0.00000
[30, 100] loss: 3.276532
Epoch: 30 Validation loss: 6.73601 accuracy: 0.86818 accuracy_scn: 0.00000
Saving Model in checkpoints/BERT_TGRU_2b_mha_100checkpoint_29
Early Stopping the training
Finished Training
Saving Model in checkpoints/BERT_TGRU_2b_mha_100final
Val loss = 6.736005783081055 	 Val accuracy = 0.8681750893592834 accuracy_scn = 0
Test loss = 6.855916500091553 	 Test accuracy = 0.8702084422111511 accuracy_scn = 0
