Using device:  cuda
Using 10 CPU cores
Training new model  <class 'model.TorchGRUIntent'>
Started Training of BERT_TGRU_2b_mha_2l
[1, 100] loss: 2.403100
[1, 200] loss: 1.513878
[1, 300] loss: 1.267675
Epoch: 1 Validation loss: 1.03349 accuracy: 0.74274 accuracy_scn: 0.75455
Saving Model in checkpoints/BERT_TGRU_2b_mha_2lcheckpoint_best
[2, 100] loss: 0.956328
[2, 200] loss: 0.953081
[2, 300] loss: 0.936459
Epoch: 2 Validation loss: 0.93683 accuracy: 0.77865 accuracy_scn: 0.82686
Saving Model in checkpoints/BERT_TGRU_2b_mha_2lcheckpoint_best
[3, 100] loss: 0.815946
[3, 200] loss: 0.797918
[3, 300] loss: 0.810926
Epoch: 3 Validation loss: 0.84313 accuracy: 0.80325 accuracy_scn: 0.85440
Saving Model in checkpoints/BERT_TGRU_2b_mha_2lcheckpoint_best
[4, 100] loss: 0.652924
[4, 200] loss: 0.682165
[4, 300] loss: 0.722003
Epoch: 4 Validation loss: 0.79108 accuracy: 0.81062 accuracy_scn: 0.87457
Saving Model in checkpoints/BERT_TGRU_2b_mha_2lcheckpoint_best
[5, 100] loss: 0.553459
[5, 200] loss: 0.576754
[5, 300] loss: 0.646813
Epoch: 5 Validation loss: 0.75379 accuracy: 0.83030 accuracy_scn: 0.87457
Saving Model in checkpoints/BERT_TGRU_2b_mha_2lcheckpoint_best
[6, 100] loss: 0.438268
[6, 200] loss: 0.488231
[6, 300] loss: 0.545132
Epoch: 6 Validation loss: 0.78560 accuracy: 0.83473 accuracy_scn: 0.88096
[7, 100] loss: 0.425344
[7, 200] loss: 0.462670
[7, 300] loss: 0.518313
Epoch: 7 Validation loss: 0.75879 accuracy: 0.84604 accuracy_scn: 0.88047
[8, 100] loss: 0.349331
[8, 200] loss: 0.421430
[8, 300] loss: 0.407377
Epoch: 8 Validation loss: 0.70780 accuracy: 0.84358 accuracy_scn: 0.88293
Saving Model in checkpoints/BERT_TGRU_2b_mha_2lcheckpoint_best
[9, 100] loss: 0.355116
[9, 200] loss: 0.333348
[9, 300] loss: 0.335380
Epoch: 9 Validation loss: 0.82116 accuracy: 0.82882 accuracy_scn: 0.86965
[10, 100] loss: 0.335640
[10, 200] loss: 0.325501
[10, 300] loss: 0.345004
Epoch: 10 Validation loss: 0.77765 accuracy: 0.83620 accuracy_scn: 0.87063
Saving Model in checkpoints/BERT_TGRU_2b_mha_2lcheckpoint_9
[11, 100] loss: 0.246859
[11, 200] loss: 0.338102
[11, 300] loss: 0.350303
Epoch: 11 Validation loss: 0.83379 accuracy: 0.84112 accuracy_scn: 0.88785
[12, 100] loss: 0.270031
[12, 200] loss: 0.271172
[12, 300] loss: 0.292370
Epoch: 12 Validation loss: 0.88540 accuracy: 0.83424 accuracy_scn: 0.88096
[13, 100] loss: 0.241445
[13, 200] loss: 0.240578
[13, 300] loss: 0.272284
Epoch: 13 Validation loss: 0.94595 accuracy: 0.85342 accuracy_scn: 0.89179
Epoch 00013: reducing learning rate of group 0 to 5.0000e-04.
[14, 100] loss: 0.150437
[14, 200] loss: 0.136028
[14, 300] loss: 0.129550
Epoch: 14 Validation loss: 0.88293 accuracy: 0.86178 accuracy_scn: 0.89621
[15, 100] loss: 0.080864
[15, 200] loss: 0.096729
[15, 300] loss: 0.109364
Epoch: 15 Validation loss: 0.86393 accuracy: 0.85834 accuracy_scn: 0.89818
[16, 100] loss: 0.089940
[16, 200] loss: 0.089293
[16, 300] loss: 0.109371
Epoch: 16 Validation loss: 0.96157 accuracy: 0.86227 accuracy_scn: 0.88933
[17, 100] loss: 0.090060
[17, 200] loss: 0.103200
[17, 300] loss: 0.119142
Epoch: 17 Validation loss: 1.02616 accuracy: 0.84801 accuracy_scn: 0.89769
Early Stopping the training
Finished Training
Saving Model in checkpoints/BERT_TGRU_2b_mha_2lfinal
Val loss = 1.0261642932891846 	 Val accuracy = 0.84800785779953 accuracy_scn = 0.897688090801239
Test loss = 1.0047188997268677 	 Test accuracy = 0.8675184845924377 accuracy_scn = 0.897108256816864
