Using device:  cuda
Using 10 CPU cores
Training new model  <class 'model.TorchGRUIntent'>
Started Training of BERT_TGRU_2b_mha_100
[1, 100] loss: 19.068150
Epoch: 1 Validation loss: 18.61309 accuracy: 0.34875 accuracy_scn: 0.00000
Saving Model in checkpoints/BERT_TGRU_2b_mha_100checkpoint_best
[2, 100] loss: 14.213222
Epoch: 2 Validation loss: 17.44813 accuracy: 0.45794 accuracy_scn: 0.00000
Saving Model in checkpoints/BERT_TGRU_2b_mha_100checkpoint_best
[3, 100] loss: 12.769013
Epoch: 3 Validation loss: 16.73864 accuracy: 0.53123 accuracy_scn: 0.00000
Saving Model in checkpoints/BERT_TGRU_2b_mha_100checkpoint_best
[4, 100] loss: 11.916849
Epoch: 4 Validation loss: 16.59017 accuracy: 0.51303 accuracy_scn: 0.00000
Saving Model in checkpoints/BERT_TGRU_2b_mha_100checkpoint_best
[5, 100] loss: 11.322998
Epoch: 5 Validation loss: 16.26528 accuracy: 0.60600 accuracy_scn: 0.00000
Saving Model in checkpoints/BERT_TGRU_2b_mha_100checkpoint_best
[6, 100] loss: 10.958151
Epoch: 6 Validation loss: 16.19748 accuracy: 0.60748 accuracy_scn: 0.00000
Saving Model in checkpoints/BERT_TGRU_2b_mha_100checkpoint_best
[7, 100] loss: 10.615559
Epoch: 7 Validation loss: 16.08438 accuracy: 0.68175 accuracy_scn: 0.00000
Saving Model in checkpoints/BERT_TGRU_2b_mha_100checkpoint_best
[8, 100] loss: 10.261333
Epoch: 8 Validation loss: 15.93583 accuracy: 0.72651 accuracy_scn: 0.00000
Saving Model in checkpoints/BERT_TGRU_2b_mha_100checkpoint_best
[9, 100] loss: 10.084139
Epoch: 9 Validation loss: 15.90222 accuracy: 0.73291 accuracy_scn: 0.00000
Saving Model in checkpoints/BERT_TGRU_2b_mha_100checkpoint_best
[10, 100] loss: 9.789381
Epoch: 10 Validation loss: 15.64503 accuracy: 0.77423 accuracy_scn: 0.00000
Saving Model in checkpoints/BERT_TGRU_2b_mha_100checkpoint_best
[11, 100] loss: 9.525496
Epoch: 11 Validation loss: 15.69770 accuracy: 0.79193 accuracy_scn: 0.00000
[12, 100] loss: 9.367296
Epoch: 12 Validation loss: 15.75941 accuracy: 0.80275 accuracy_scn: 0.00000
[13, 100] loss: 9.186703
Epoch: 13 Validation loss: 15.94137 accuracy: 0.81013 accuracy_scn: 0.00000
[14, 100] loss: 8.958634
Epoch: 14 Validation loss: 15.82776 accuracy: 0.82538 accuracy_scn: 0.00000
[15, 100] loss: 8.932372
Epoch: 15 Validation loss: 15.74609 accuracy: 0.81259 accuracy_scn: 0.00000
Epoch 00015: reducing learning rate of group 0 to 5.0000e-04.
[16, 100] loss: 8.685296
Epoch: 16 Validation loss: 15.57348 accuracy: 0.83768 accuracy_scn: 0.00000
Saving Model in checkpoints/BERT_TGRU_2b_mha_100checkpoint_best
[17, 100] loss: 8.406053
Epoch: 17 Validation loss: 15.70977 accuracy: 0.83965 accuracy_scn: 0.00000
[18, 100] loss: 8.487932
Epoch: 18 Validation loss: 15.73092 accuracy: 0.83719 accuracy_scn: 0.00000
[19, 100] loss: 8.424629
Epoch: 19 Validation loss: 15.59800 accuracy: 0.84456 accuracy_scn: 0.00000
[20, 100] loss: 8.437460
Epoch: 20 Validation loss: 15.66829 accuracy: 0.84358 accuracy_scn: 0.00000
Saving Model in checkpoints/BERT_TGRU_2b_mha_100checkpoint_19
[21, 100] loss: 8.288323
Epoch: 21 Validation loss: 15.75047 accuracy: 0.84604 accuracy_scn: 0.00000
Epoch 00021: reducing learning rate of group 0 to 2.5000e-04.
[22, 100] loss: 8.302938
Epoch: 22 Validation loss: 15.78119 accuracy: 0.84899 accuracy_scn: 0.00000
[23, 100] loss: 8.171078
Epoch: 23 Validation loss: 15.57550 accuracy: 0.85293 accuracy_scn: 0.00000
[24, 100] loss: 8.148220
Epoch: 24 Validation loss: 15.72029 accuracy: 0.85735 accuracy_scn: 0.00000
[25, 100] loss: 8.123524
Epoch: 25 Validation loss: 15.89822 accuracy: 0.85588 accuracy_scn: 0.00000
Early Stopping the training
Finished Training
Saving Model in checkpoints/BERT_TGRU_2b_mha_100final
Val loss = 15.898216247558594 	 Val accuracy = 0.8558779954910278 accuracy_scn = 0
Test loss = 16.06654167175293 	 Test accuracy = 0.8607935309410095 accuracy_scn = 0
