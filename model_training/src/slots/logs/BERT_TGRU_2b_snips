Using device:  cuda
Using 15 CPU cores
Training new model  <class 'model.TorchGRU'>
Started Training of BERT_TGRU_2b_snips
[1, 100] loss: 1.124502
[1, 200] loss: 0.383184
[1, 300] loss: 0.286347
[1, 400] loss: 0.246983
Epoch: 1 Validation loss: 2.56723 accuracy: 0.95752
Saving Model in checkpoints/BERT_TGRU_2b_snipscheckpoint_best
[2, 100] loss: 0.165625
[2, 200] loss: 0.174161
[2, 300] loss: 0.157303
[2, 400] loss: 0.161130
Epoch: 2 Validation loss: 1.68252 accuracy: 0.97211
Saving Model in checkpoints/BERT_TGRU_2b_snipscheckpoint_best
[3, 100] loss: 0.111162
[3, 200] loss: 0.103896
[3, 300] loss: 0.106893
[3, 400] loss: 0.118936
Epoch: 3 Validation loss: 1.15694 accuracy: 0.97849
Saving Model in checkpoints/BERT_TGRU_2b_snipscheckpoint_best
[4, 100] loss: 0.075141
[4, 200] loss: 0.077166
[4, 300] loss: 0.087835
[4, 400] loss: 0.088954
Epoch: 4 Validation loss: 0.82149 accuracy: 0.98541
Saving Model in checkpoints/BERT_TGRU_2b_snipscheckpoint_best
[5, 100] loss: 0.061446
[5, 200] loss: 0.064937
[5, 300] loss: 0.068179
[5, 400] loss: 0.068458
Epoch: 5 Validation loss: 0.49561 accuracy: 0.99138
Saving Model in checkpoints/BERT_TGRU_2b_snipscheckpoint_best
[6, 100] loss: 0.054378
[6, 200] loss: 0.056517
[6, 300] loss: 0.054787
[6, 400] loss: 0.055687
Epoch: 6 Validation loss: 0.39598 accuracy: 0.99319
Saving Model in checkpoints/BERT_TGRU_2b_snipscheckpoint_best
[7, 100] loss: 0.045119
[7, 200] loss: 0.038942
[7, 300] loss: 0.049920
[7, 400] loss: 0.044062
Epoch: 7 Validation loss: 0.26085 accuracy: 0.99578
Saving Model in checkpoints/BERT_TGRU_2b_snipscheckpoint_best
[8, 100] loss: 0.038626
[8, 200] loss: 0.034356
[8, 300] loss: 0.042101
[8, 400] loss: 0.043038
Epoch: 8 Validation loss: 0.21079 accuracy: 0.99674
Saving Model in checkpoints/BERT_TGRU_2b_snipscheckpoint_best
[9, 100] loss: 0.028872
[9, 200] loss: 0.030852
[9, 300] loss: 0.030883
[9, 400] loss: 0.032417
Epoch: 9 Validation loss: 0.15964 accuracy: 0.99757
Saving Model in checkpoints/BERT_TGRU_2b_snipscheckpoint_best
[10, 100] loss: 0.024182
[10, 200] loss: 0.027278
[10, 300] loss: 0.030317
[10, 400] loss: 0.031507
Epoch: 10 Validation loss: 0.13767 accuracy: 0.99777
Saving Model in checkpoints/BERT_TGRU_2b_snipscheckpoint_best
[11, 100] loss: 0.029027
[11, 200] loss: 0.030254
[11, 300] loss: 0.034016
[11, 400] loss: 0.039771
Epoch: 11 Validation loss: 0.19852 accuracy: 0.99664
[12, 100] loss: 0.028954
[12, 200] loss: 0.021564
[12, 300] loss: 0.027233
[12, 400] loss: 0.031291
Epoch: 12 Validation loss: 0.10634 accuracy: 0.99842
Saving Model in checkpoints/BERT_TGRU_2b_snipscheckpoint_best
[13, 100] loss: 0.020024
[13, 200] loss: 0.023077
[13, 300] loss: 0.023194
[13, 400] loss: 0.027920
Epoch: 13 Validation loss: 0.17328 accuracy: 0.99702
[14, 100] loss: 0.019071
[14, 200] loss: 0.027609
[14, 300] loss: 0.023875
[14, 400] loss: 0.023810
Epoch: 14 Validation loss: 0.09518 accuracy: 0.99845
Saving Model in checkpoints/BERT_TGRU_2b_snipscheckpoint_best
[15, 100] loss: 0.020503
[15, 200] loss: 0.020704
[15, 300] loss: 0.020319
[15, 400] loss: 0.025586
Epoch: 15 Validation loss: 0.17850 accuracy: 0.99686
[16, 100] loss: 0.022215
[16, 200] loss: 0.019968
[16, 300] loss: 0.027435
[16, 400] loss: 0.025802
Epoch: 16 Validation loss: 0.11574 accuracy: 0.99813
[17, 100] loss: 0.019834
[17, 200] loss: 0.019045
[17, 300] loss: 0.025172
[17, 400] loss: 0.026443
Epoch: 17 Validation loss: 0.29567 accuracy: 0.99538
[18, 100] loss: 0.017965
[18, 200] loss: 0.017787
[18, 300] loss: 0.022133
[18, 400] loss: 0.022034
Epoch: 18 Validation loss: 0.09717 accuracy: 0.99826
[19, 100] loss: 0.018174
[19, 200] loss: 0.015885
[19, 300] loss: 0.021276
[19, 400] loss: 0.019915
Epoch: 19 Validation loss: 0.10790 accuracy: 0.99817
Epoch 00019: reducing learning rate of group 0 to 5.0000e-04.
[20, 100] loss: 0.014266
[20, 200] loss: 0.010502
[20, 300] loss: 0.008552
[20, 400] loss: 0.009457
Epoch: 20 Validation loss: 0.01600 accuracy: 0.99987
Saving Model in checkpoints/BERT_TGRU_2b_snipscheckpoint_best
[21, 100] loss: 0.008164
[21, 200] loss: 0.007286
[21, 300] loss: 0.008534
[21, 400] loss: 0.007982
Epoch: 21 Validation loss: 0.01591 accuracy: 0.99982
Saving Model in checkpoints/BERT_TGRU_2b_snipscheckpoint_best
[22, 100] loss: 0.005759
[22, 200] loss: 0.005471
[22, 300] loss: 0.006403
[22, 400] loss: 0.007718
Epoch: 22 Validation loss: 0.01517 accuracy: 0.99973
Saving Model in checkpoints/BERT_TGRU_2b_snipscheckpoint_best
[23, 100] loss: 0.004906
[23, 200] loss: 0.006503
[23, 300] loss: 0.006080
[23, 400] loss: 0.009523
Epoch: 23 Validation loss: 0.03132 accuracy: 0.99947
[24, 100] loss: 0.007896
[24, 200] loss: 0.007714
[24, 300] loss: 0.006859
[24, 400] loss: 0.007300
Epoch: 24 Validation loss: 0.01046 accuracy: 0.99988
Saving Model in checkpoints/BERT_TGRU_2b_snipscheckpoint_best
[25, 100] loss: 0.005792
[25, 200] loss: 0.006888
[25, 300] loss: 0.006388
[25, 400] loss: 0.007136
Epoch: 25 Validation loss: 0.01163 accuracy: 0.99986
[26, 100] loss: 0.006309
[26, 200] loss: 0.007483
[26, 300] loss: 0.006232
[26, 400] loss: 0.009039
Epoch: 26 Validation loss: 0.01836 accuracy: 0.99968
[27, 100] loss: 0.006517
[27, 200] loss: 0.006031
[27, 300] loss: 0.006701
[27, 400] loss: 0.006753
Epoch: 27 Validation loss: 0.01458 accuracy: 0.99976
[28, 100] loss: 0.005095
[28, 200] loss: 0.005908
[28, 300] loss: 0.004535
[28, 400] loss: 0.006592
Epoch: 28 Validation loss: 0.01025 accuracy: 0.99984
Saving Model in checkpoints/BERT_TGRU_2b_snipscheckpoint_best
[29, 100] loss: 0.005602
[29, 200] loss: 0.006452
[29, 300] loss: 0.005601
[29, 400] loss: 0.005789
Epoch: 29 Validation loss: 0.01520 accuracy: 0.99977
[30, 100] loss: 0.008859
[30, 200] loss: 0.006140
[30, 300] loss: 0.008058
[30, 400] loss: 0.005637
Epoch: 30 Validation loss: 0.01348 accuracy: 0.99980
Saving Model in checkpoints/BERT_TGRU_2b_snipscheckpoint_29
[31, 100] loss: 0.005531
[31, 200] loss: 0.006693
[31, 300] loss: 0.007966
[31, 400] loss: 0.005312
Epoch: 31 Validation loss: 0.01570 accuracy: 0.99975
[32, 100] loss: 0.006533
[32, 200] loss: 0.008424
[32, 300] loss: 0.005652
[32, 400] loss: 0.006458
Epoch: 32 Validation loss: 0.00831 accuracy: 0.99990
Saving Model in checkpoints/BERT_TGRU_2b_snipscheckpoint_best
[33, 100] loss: 0.004843
[33, 200] loss: 0.004063
[33, 300] loss: 0.007334
[33, 400] loss: 0.006911
Epoch: 33 Validation loss: 0.01581 accuracy: 0.99973
[34, 100] loss: 0.006081
[34, 200] loss: 0.006446
[34, 300] loss: 0.005280
[34, 400] loss: 0.005361
Epoch: 34 Validation loss: 0.00964 accuracy: 0.99986
[35, 100] loss: 0.006526
[35, 200] loss: 0.006874
[35, 300] loss: 0.005091
[35, 400] loss: 0.005310
Epoch: 35 Validation loss: 0.00817 accuracy: 0.99990
Saving Model in checkpoints/BERT_TGRU_2b_snipscheckpoint_best
[36, 100] loss: 0.005815
[36, 200] loss: 0.007770
[36, 300] loss: 0.007834
[36, 400] loss: 0.006835
Epoch: 36 Validation loss: 0.01081 accuracy: 0.99983
[37, 100] loss: 0.006260
[37, 200] loss: 0.006561
[37, 300] loss: 0.006059
[37, 400] loss: 0.006695
Epoch: 37 Validation loss: 0.01469 accuracy: 0.99975
[38, 100] loss: 0.005037
[38, 200] loss: 0.006461
[38, 300] loss: 0.006056
[38, 400] loss: 0.007082
Epoch: 38 Validation loss: 0.01542 accuracy: 0.99980
[39, 100] loss: 0.006078
[39, 200] loss: 0.008390
[39, 300] loss: 0.006032
[39, 400] loss: 0.006699
Epoch: 39 Validation loss: 0.01412 accuracy: 0.99970
[40, 100] loss: 0.005598
[40, 200] loss: 0.004214
[40, 300] loss: 0.004931
[40, 400] loss: 0.004974
Epoch: 40 Validation loss: 0.00674 accuracy: 0.99992
Saving Model in checkpoints/BERT_TGRU_2b_snipscheckpoint_best
[41, 100] loss: 0.005477
[41, 200] loss: 0.004848
[41, 300] loss: 0.005305
[41, 400] loss: 0.006619
Epoch: 41 Validation loss: 0.00781 accuracy: 0.99995
[42, 100] loss: 0.007467
[42, 200] loss: 0.006506
[42, 300] loss: 0.005080
[42, 400] loss: 0.005547
Epoch: 42 Validation loss: 0.00951 accuracy: 0.99984
[43, 100] loss: 0.004639
[43, 200] loss: 0.006247
[43, 300] loss: 0.005653
[43, 400] loss: 0.005848
Epoch: 43 Validation loss: 0.00649 accuracy: 0.99993
Saving Model in checkpoints/BERT_TGRU_2b_snipscheckpoint_best
[44, 100] loss: 0.005979
[44, 200] loss: 0.006492
[44, 300] loss: 0.004818
[44, 400] loss: 0.004724
Epoch: 44 Validation loss: 0.00895 accuracy: 0.99986
[45, 100] loss: 0.004108
[45, 200] loss: 0.004662
[45, 300] loss: 0.005902
[45, 400] loss: 0.006267
Epoch: 45 Validation loss: 0.00754 accuracy: 0.99988
[46, 100] loss: 0.006118
[46, 200] loss: 0.005202
[46, 300] loss: 0.008467
[46, 400] loss: 0.005780
Epoch: 46 Validation loss: 0.01314 accuracy: 0.99977
[47, 100] loss: 0.005580
[47, 200] loss: 0.006037
[47, 300] loss: 0.006227
[47, 400] loss: 0.005610
Epoch: 47 Validation loss: 0.00915 accuracy: 0.99991
[48, 100] loss: 0.005147
[48, 200] loss: 0.005764
[48, 300] loss: 0.004088
[48, 400] loss: 0.003650
Epoch: 48 Validation loss: 0.00955 accuracy: 0.99982
Epoch 00048: reducing learning rate of group 0 to 2.5000e-04.
[49, 100] loss: 0.003672
[49, 200] loss: 0.002309
[49, 300] loss: 0.003636
[49, 400] loss: 0.002163
Epoch: 49 Validation loss: 0.00228 accuracy: 0.99998
Saving Model in checkpoints/BERT_TGRU_2b_snipscheckpoint_best
[50, 100] loss: 0.003198
[50, 200] loss: 0.003216
[50, 300] loss: 0.003003
[50, 400] loss: 0.003035
Epoch: 50 Validation loss: 0.00208 accuracy: 0.99998
Saving Model in checkpoints/BERT_TGRU_2b_snipscheckpoint_best
[51, 100] loss: 0.002601
[51, 200] loss: 0.002656
[51, 300] loss: 0.002554
[51, 400] loss: 0.002747
Epoch: 51 Validation loss: 0.00144 accuracy: 0.99998
Saving Model in checkpoints/BERT_TGRU_2b_snipscheckpoint_best
[52, 100] loss: 0.001848
[52, 200] loss: 0.001898
[52, 300] loss: 0.002270
[52, 400] loss: 0.002435
Epoch: 52 Validation loss: 0.00140 accuracy: 0.99999
Saving Model in checkpoints/BERT_TGRU_2b_snipscheckpoint_best
[53, 100] loss: 0.003501
[53, 200] loss: 0.002981
[53, 300] loss: 0.003559
[53, 400] loss: 0.003158
Epoch: 53 Validation loss: 0.00270 accuracy: 0.99997
[54, 100] loss: 0.001971
[54, 200] loss: 0.002231
[54, 300] loss: 0.003595
[54, 400] loss: 0.002332
Epoch: 54 Validation loss: 0.00165 accuracy: 0.99998
External instruction to stop the training
Finished Training
Saving Model in checkpoints/BERT_TGRU_2b_snipsfinal
Test loss = 0.0016063244547694921 	 Test accuracy = 0.999983007646559
Train loss = 7.573344191769138e-05       Train accuracy = 0.9999915038232795
Val loss = 0.001418091356754303          Val accuracy = 0.9999915038232795
Test loss = 0.0013546849368140101        Test accuracy = 0.9999915038232795
8426
Train - Accuracy: 0.999983012676239
Val - Accuracy: 0.9722744226455688
Test - Accuracy: 0.9721435308456421
