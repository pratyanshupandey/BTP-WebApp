Using device:  cuda
Using 15 CPU cores
Training new model  <class 'model.TransformerIntent'>
Started Training of BERT_TGRU_2b_snips
[1, 100] loss: 0.119302
[1, 200] loss: 0.043643
[1, 300] loss: 0.036986
[1, 400] loss: 0.040408
Epoch: 1 Validation loss: 0.02146 accuracy: 0.97857
Saving Model in checkpoints/BERT_TGRU_2b_snipscheckpoint_best
[2, 100] loss: 0.034438
[2, 200] loss: 0.030794
[2, 300] loss: 0.028882
[2, 400] loss: 0.033222
Epoch: 2 Validation loss: 0.01841 accuracy: 0.98000
Saving Model in checkpoints/BERT_TGRU_2b_snipscheckpoint_best
[3, 100] loss: 0.021775
[3, 200] loss: 0.029174
[3, 300] loss: 0.025388
[3, 400] loss: 0.026794
Epoch: 3 Validation loss: 0.01724 accuracy: 0.98000
Saving Model in checkpoints/BERT_TGRU_2b_snipscheckpoint_best
[4, 100] loss: 0.023333
[4, 200] loss: 0.023444
[4, 300] loss: 0.032038
[4, 400] loss: 0.022300
Epoch: 4 Validation loss: 0.01842 accuracy: 0.97857
[5, 100] loss: 0.016212
[5, 200] loss: 0.021159
[5, 300] loss: 0.016724
[5, 400] loss: 0.020695
Epoch: 5 Validation loss: 0.02323 accuracy: 0.98143
[6, 100] loss: 0.020380
[6, 200] loss: 0.021719
[6, 300] loss: 0.024822
[6, 400] loss: 0.020520
Epoch: 6 Validation loss: 0.01781 accuracy: 0.98000
[7, 100] loss: 0.019305
[7, 200] loss: 0.017050
[7, 300] loss: 0.019165
[7, 400] loss: 0.023526
Epoch: 7 Validation loss: 0.02286 accuracy: 0.97857
[8, 100] loss: 0.017559
[8, 200] loss: 0.016603
[8, 300] loss: 0.018495
[8, 400] loss: 0.023432
Epoch: 8 Validation loss: 0.01917 accuracy: 0.97857
Epoch 00008: reducing learning rate of group 0 to 5.0000e-04.
[9, 100] loss: 0.016330
[9, 200] loss: 0.011210
[9, 300] loss: 0.012540
[9, 400] loss: 0.019852
Epoch: 9 Validation loss: 0.01494 accuracy: 0.98286
Saving Model in checkpoints/BERT_TGRU_2b_snipscheckpoint_best
[10, 100] loss: 0.013426
[10, 200] loss: 0.013354
[10, 300] loss: 0.013161
[10, 400] loss: 0.010817
Epoch: 10 Validation loss: 0.01259 accuracy: 0.98429
Saving Model in checkpoints/BERT_TGRU_2b_snipscheckpoint_best
[11, 100] loss: 0.013442
[11, 200] loss: 0.011822
[11, 300] loss: 0.013540
[11, 400] loss: 0.012466
Epoch: 11 Validation loss: 0.01384 accuracy: 0.98429
[12, 100] loss: 0.014495
[12, 200] loss: 0.014374
[12, 300] loss: 0.011605
[12, 400] loss: 0.011292
Epoch: 12 Validation loss: 0.01563 accuracy: 0.98286
[13, 100] loss: 0.009815
[13, 200] loss: 0.011699
[13, 300] loss: 0.012518
[13, 400] loss: 0.013070
Epoch: 13 Validation loss: 0.01056 accuracy: 0.98429
Saving Model in checkpoints/BERT_TGRU_2b_snipscheckpoint_best
[14, 100] loss: 0.010328
[14, 200] loss: 0.011107
[14, 300] loss: 0.011261
[14, 400] loss: 0.014093
Epoch: 14 Validation loss: 0.01680 accuracy: 0.97714
[15, 100] loss: 0.013426
[15, 200] loss: 0.011553
[15, 300] loss: 0.013018
[15, 400] loss: 0.011789
Epoch: 15 Validation loss: 0.01369 accuracy: 0.98429
[16, 100] loss: 0.010840
[16, 200] loss: 0.009239
[16, 300] loss: 0.017391
[16, 400] loss: 0.010303
Epoch: 16 Validation loss: 0.01348 accuracy: 0.98429
[17, 100] loss: 0.010232
[17, 200] loss: 0.019810
[17, 300] loss: 0.010822
[17, 400] loss: 0.009448
Epoch: 17 Validation loss: 0.01599 accuracy: 0.98286
[18, 100] loss: 0.013933
[18, 200] loss: 0.011770
[18, 300] loss: 0.010387
[18, 400] loss: 0.010285
Epoch: 18 Validation loss: 0.01743 accuracy: 0.98000
Epoch 00018: reducing learning rate of group 0 to 2.5000e-04.
[19, 100] loss: 0.010486
[19, 200] loss: 0.008609
[19, 300] loss: 0.009959
[19, 400] loss: 0.007939
Epoch: 19 Validation loss: 0.01432 accuracy: 0.98429
[20, 100] loss: 0.007235
[20, 200] loss: 0.007635
[20, 300] loss: 0.008393
[20, 400] loss: 0.007725
Epoch: 20 Validation loss: 0.00936 accuracy: 0.98571
Saving Model in checkpoints/BERT_TGRU_2b_snipscheckpoint_best
[21, 100] loss: 0.007283
[21, 200] loss: 0.009444
[21, 300] loss: 0.008589
[21, 400] loss: 0.007861
Epoch: 21 Validation loss: 0.01481 accuracy: 0.98286
[22, 100] loss: 0.008925
[22, 200] loss: 0.008591
[22, 300] loss: 0.009615
[22, 400] loss: 0.009379
Epoch: 22 Validation loss: 0.01831 accuracy: 0.98571
[23, 100] loss: 0.005778
[23, 200] loss: 0.009631
[23, 300] loss: 0.006995
[23, 400] loss: 0.009227
Epoch: 23 Validation loss: 0.01309 accuracy: 0.98571
[24, 100] loss: 0.007194
[24, 200] loss: 0.007900
[24, 300] loss: 0.008368
[24, 400] loss: 0.007386
Epoch: 24 Validation loss: 0.01284 accuracy: 0.98714
[25, 100] loss: 0.007217
[25, 200] loss: 0.007064
[25, 300] loss: 0.008213
[25, 400] loss: 0.007964
Epoch: 25 Validation loss: 0.01141 accuracy: 0.98571
Epoch 00025: reducing learning rate of group 0 to 1.2500e-04.
[26, 100] loss: 0.007370
[26, 200] loss: 0.007147
[26, 300] loss: 0.006503
[26, 400] loss: 0.005723
Epoch: 26 Validation loss: 0.01159 accuracy: 0.98714
[27, 100] loss: 0.006625
[27, 200] loss: 0.006454
[27, 300] loss: 0.006665
[27, 400] loss: 0.004366
Epoch: 27 Validation loss: 0.01288 accuracy: 0.98857
[28, 100] loss: 0.005937
[28, 200] loss: 0.007398
[28, 300] loss: 0.006178
[28, 400] loss: 0.004883
Epoch: 28 Validation loss: 0.01368 accuracy: 0.98714
[29, 100] loss: 0.004977
[29, 200] loss: 0.005602
[29, 300] loss: 0.006287
[29, 400] loss: 0.006418
Epoch: 29 Validation loss: 0.01187 accuracy: 0.98714
Early Stopping the training
Finished Training
Saving Model in checkpoints/BERT_TGRU_2b_snipsfinal
Val loss = 0.011866934597492218 	 Val accuracy = tensor([0.9871], device='cuda:0')
Test loss = 0.030267857015132904 	 Test accuracy = tensor([0.9671], device='cuda:0')
Using model from checkpoints/BERT_TGRU_2b_snipscheckpoint_best.pt
Val loss = 0.009362451732158661          Val accuracy = tensor([0.9857], device='cuda:0')
Test loss = 0.024913834407925606         Test accuracy = tensor([0.9714], device='cuda:0')